{
    "description": "Resolves all gosec linter warnings by restricting file/directory permissions and acknowledging safe file inclusion paths.",
    "steps": [
      {
        "type": "file_modification",
        "description": "Fix permissions in cmd/apply.go and cmd/build.go",
        "changes": [
          {
            "file_path": "cmd/apply.go",
            "operations": [
              {
                "type": "regex_replace",
                "find_regex": "0755",
                "replace_with": "0750"
              }
            ]
          },
          {
            "file_path": "cmd/build.go",
            "operations": [
              {
                "type": "regex_replace",
                "find_regex": "0755",
                "replace_with": "0750"
              }
            ]
          }
        ]
      },
      {
        "type": "file_modification",
        "description": "Fix permissions in internal/config/config.go and its test.",
        "changes": [
          {
            "file_path": "internal/config/config.go",
            "operations": [
              {
                "type": "regex_replace",
                "find_regex": "0755",
                "replace_with": "0750"
              }
            ]
          },
          {
            "file_path": "internal/config/config_test.go",
            "operations": [
              {
                "type": "regex_replace",
                "find_regex": "0644",
                "replace_with": "0600"
              }
            ]
          }
        ]
      },
      {
        "type": "file_modification",
        "description": "Fix file inclusion warnings and permissions in internal/contextgen/helpers.go",
        "changes": [
          {
            "file_path": "internal/contextgen/helpers.go",
            "operations": [
              {
                "type": "regex_replace",
                "find_regex": "(\\s*)(content, readErr := os.ReadFile\\(path\\))",
                "replace_with": "$1//gosec:G304\n$1$2"
              },
              {
                "type": "regex_replace",
                "find_regex": "(\\s*)(f, err := os.OpenFile\\(outputFile, os.O_APPEND|os.O_CREATE|os.O_WRONLY, )0644(\\))",
                "replace_with": "$1//gosec:G304\n$1$20600$3"
              }
            ]
          }
        ]
      },
      {
        "type": "file_modification",
        "description": "Fix file inclusion warning and permissions in internal/tools/io.go",
        "changes": [
          {
            "file_path": "internal/tools/io.go",
            "operations": [
              {
                "type": "regex_replace",
                "find_regex": "(\\s*)(content, err := os.ReadFile\\(filePath\\))",
                "replace_with": "$1//gosec:G304\n$1$2"
              },
              {
                "type": "regex_replace",
                "find_regex": "0644",
                "replace_with": "0600"
              }
            ]
          }
        ]
      }
    ]
  }